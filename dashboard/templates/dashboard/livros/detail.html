{% extends 'dashboard/base.html' %}
{% load static %}
{% load format_duration %}

{% block title %}Momentum | Management Dashboard gestão movie   {% endblock %}


{% block dashboard %}

<style type="text/css">
	.pd-wrap {
	
	font-family: 'Poppins', sans-serif;
}
.heading-section {
	text-align: center;
	margin-bottom: 20px;
}
.sub-heading {
	font-family: 'Poppins', sans-serif;
    font-size: 12px;
    display: block;
    font-weight: 600;
    color: #2e9ca1;
    text-transform: uppercase;
    letter-spacing: 2px;
}
.heading-section h2 {
	font-size: 32px;
    font-weight: 500;
    padding-top: 10px;
    padding-bottom: 15px;
	font-family: 'Poppins', sans-serif;
}
.user-img {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    position: relative;
	min-width: 80px;
	background-size: 100%;
}
.carousel-testimonial .item {
	padding: 30px 10px;
}
.quote {
	position: absolute;
    top: -23px;
    color: #2e9da1;
    font-size: 27px;
}
.name {
	margin-bottom: 0;
    line-height: 14px;
    font-size: 17px;
    font-weight: 500;
}
.position {
	color: #adadad;
	font-size: 14px;
}
.owl-nav button {
	position: absolute;
	top: 50%;
	transform: translate(0, -50%);
	outline: none;
	height: 25px;
}
.owl-nav button svg {
	width: 25px;
	height: 25px;
}
.owl-nav button.owl-prev {
	left: 25px;
}
.owl-nav button.owl-next {
	right: 25px;
}
.owl-nav button span {
	font-size: 45px;
}
.product-thumb .item img {
	height: 100px;
}
.product-name {
	font-size: 22px;
	font-weight: 500;
	line-height: 22px;
	margin-bottom: 4px;
}
.product-price-discount {
	font-size: 22px;
    font-weight: 400;
    padding: 10px 0;
    clear: both;
}
.product-price-discount span.line-through {
	text-decoration: line-through;
    margin-left: 10px;
    font-size: 14px;
    vertical-align: middle;
    color: #a5a5a5;
}
.display-flex {
	display: flex;
}
.align-center {
	align-items: center;
}
.product-info {
	width: 100%;
}
.reviews-counter {
    font-size: 13px;
}
.reviews-counter span {
	vertical-align: -2px;
}
.rate {
    float: left;
    padding: 0 10px 0 0;
}
.rate:not(:checked) > input {
    position:absolute;
    top:-9999px;
}
.rate:not(:checked) > label {
    float: right;
    width: 15px;
    overflow: hidden;
    white-space: nowrap;
    cursor: pointer;
    font-size: 21px;
    color:#ccc;
	margin-bottom: 0;
	line-height: 21px;
}
.rate:not(:checked) > label:before {
    content: '\2605';
}
.rate > input:checked ~ label {
    color: #ffc700;    
}
.rate:not(:checked) > label:hover,
.rate:not(:checked) > label:hover ~ label {
    color: #deb217;  
}
.rate > input:checked + label:hover,
.rate > input:checked + label:hover ~ label,
.rate > input:checked ~ label:hover,
.rate > input:checked ~ label:hover ~ label,
.rate > label:hover ~ input:checked ~ label {
    color: #c59b08;
}
.product-dtl p {
	font-size: 14px;
	line-height: 24px;
	color: #7a7a7a;
}
.product-dtl .form-control {
	font-size: 15px;
}
.product-dtl label {
	line-height: 16px;
	font-size: 15px;
}
.form-control:focus {
	outline: none;
	box-shadow: none;
}
.product-count {
	margin-top: 15px; 
}
.product-count .qtyminus,
.product-count .qtyplus {
	width: 34px;
    height: 34px;
    background: #212529;
    text-align: center;
    font-size: 19px;
    line-height: 36px;
    color: #fff;
    cursor: pointer;
}
.product-count .qtyminus {
	border-radius: 3px 0 0 3px; 
}
.product-count .qtyplus {
	border-radius: 0 3px 3px 0; 
}
.product-count .qty {
	width: 60px;
	text-align: center;
}
.round-black-btn {
	border-radius: 4px;
    background: #212529;
    color: #fff;
    padding: 7px 45px;
    display: inline-block;
    margin-top: 20px;
    border: solid 2px #212529; 
    transition: all 0.5s ease-in-out 0s;
}
.round-black-btn:hover,
.round-black-btn:focus {
	background: transparent;
	color: #212529;
	text-decoration: none;
}

.product-info-tabs {
	margin-top: 25px; 
}
.product-info-tabs .nav-tabs {
	border-bottom: 2px solid #d8d8d8;
}
.product-info-tabs .nav-tabs .nav-item {
	margin-bottom: 0;
}
.product-info-tabs .nav-tabs .nav-link {
	border: none; 
	border-bottom: 2px solid transparent;
	color: #323232;
}
.product-info-tabs .nav-tabs .nav-item .nav-link:hover {
	border: none; 
}
.product-info-tabs .nav-tabs .nav-item.show .nav-link, 
.product-info-tabs .nav-tabs .nav-link.active, 
.product-info-tabs .nav-tabs .nav-link.active:hover {
	border: none; 
	border-bottom: 2px solid #d8d8d8;
	font-weight: bold;
}
.product-info-tabs .tab-content .tab-pane {
	padding: 30px 20px;
	font-size: 15px;
	line-height: 24px;
	color: #7a7a7a;
}
.review-form .form-group {
	clear: both;
}
.mb-20 {
	margin-bottom: 20px;
}
#review
{
	width: 100%;
}

.review-form .rate {
	float: none;
	display: inline-block;
}
.review-heading {
	font-size: 24px;
    font-weight: 600;
    line-height: 24px;
    margin-bottom: 6px;
    text-transform: uppercase;
    color: #000;
}
.review-form .form-control {
	font-size: 14px;
}
.review-form input.form-control {
	height: 40px;
}
.review-form textarea.form-control {
	resize: none;
}
.review-form .round-black-btn {
	text-transform: uppercase;
	cursor: pointer;
}


.bottom-icone
{
	float: right;
	width: 100%;
	
}

.bottom-icone i
{
	float: right;
	font-size: 40px;
}

.bottom-icone i:hover
{
	color: #e4bb23;
}

.capa-img
{
	width: 100%;
}
</style>




<link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700,800&display=swap" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css">
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css">
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.theme.default.min.css"><div class="pd-wrap">
	<script src="https://code.responsivevoice.org/responsivevoice.js?key=S4Q6EnZo"></script>
	<script type="text/javascript">responsiveVoice.setDefaultVoice('Brazilian Portuguese Female');</script>

<div style="height: 110px!important;" class="section-header">

    <br>
    <h5 style="margin-top: -28px; color:#cccccc;" class="position-absolute ml-2 mb-4">Livro</h5>
    <br>
    <h1 style="color: #8898aa; font-size: 40px;" class="mt-4 ml-2">{{ livro |truncatechars:40 }}</h1>
    <div class="section-header-breadcrumb">       
        <i style="font-size: 70px; color: #000066;" class="fab fa-leanpub"></i>
    </div>
</div>

<div class="section-body">
		<a style="position: relative;  cursor: pointer; z-index: 9999999999;" href="{% url 'dashboard:list_livros' %}">
    	<div class=" float-left icon-top text-dark add-despesas " title="Voltar">
            <i style="font-size: 40px;" class="fas fa-reply-all"></i>
        </div>
    </a>
    <br>
	<h2 class="section-title">Detalhes do livro</h2>
    <p class="section-lead">
        {{ livro | safe }}.
    </p>

    <div class="row"> 
		<div class="container">	        
	        <div class="row">
	        	<div class="col-md-5">
	        		<img width="100" class="capa-img" src="{{ livro.capa }}" />
	        	</div>
	        	<div class="col-md-7">
	        		<div class="product-dtl">
        				<div class="product-info">
		        			<div class="product-name">{% for autor in livro.autor.all %}{{ autor }}{% endfor %}</div>
		        			<label for="color">Editora</label>
							<label for="color">{{ livro.editora}}</label>
		        			<div class="reviews-counter">
		        				<form action="{% url 'livros:add_review' livro.id  %}" method="POST">
            						{% csrf_token %}	
									<div class="rating-pro">
										 <label>
										   <button type="submit" name="rate" value="10" id="rangeInput" title="10 stars"> 10</button>
										 </label>
										<label>
										  <button type="submit" name="rate" value="9" id="rangeInput" title="9 stars"> 9</button>
										</label>
										<label>
										  <button type="submit" name="rate" value="8" id="rangeInput" title="8 stars"> 8</button>
										</label>
										<label>
										  <button type="submit" name="rate" value="7" id="rangeInput" title="7 stars"> 7</button>
										</label>
										<label>
										 <button type="submit" name="rate" value="6" id="rangeInput" title="6 stars"> 6</button>
										</label>
										<label>
										 <button type="submit" name="rate" value="5" id="rangeInput" title="5 stars"> 5</button>
										</label>
										<label>
											<button type="radio" name="rate" value="4" id="rangeInput" title="4 stars"> 4</button>
										</label>
										<label>
											<button type="submit" name="rate" value="3" id="rangeInput" title="3 stars"> 3</button>
										</label>
										<label>
											<button type="submit" name="rate" value="2" id="rangeInput" title="2 stars"> 2</button>
										</label>
										<label>
											<button type="submit" name="rate" value="1" id="rangeInput" title="1 star"> 1</button>
										</label>
									</div>
								</form>
								<span>
									{% if livro.classificacao <= 0 %}
				                    <span >0 Reviews</span>
				                    {% elif livro.classificacao == None  %}
				                    <span >0 Reviews</span>
				                    {% else %}
				                    <span >{{ livro.classificacao }} Reviews</span>
				                    {% endif %}								
								</span>
								<p class="mt-5">
			        				categorias:
			        				<div class="badges">
			        					{% for categoria in livro.genero.all %}
				                    	<span class="badge badge-primary">{{ categoria }}</span>
			        					{% endfor %}				                     
				                    </div>	        					
			        			</p>
							</div>		        			
		        		</div>
		        		<p class="mt-5">
	        				O total de visualizações: {{ livro.views }}	        					
	        			</p>
	        			
	        				{{ livro.descricao | safe |truncatechars:140 }}
	        			
	        			<div class="row">
	        				<div class="col-md-3">
	        					<label for="size">Paginas</label>
								<div class="product-price-discount">Nº <span>{{ livro.paginas}}</span></div>
	        				</div>	        			
	        			<div class="col-md-12">
	        				<a href="{% url 'livros:add_leitura' livro.id  %}" class="round-black-btn">Adicionar a Leitura</a>
	        			</div>
	        		</div>
	        	</div>
	        </div>
	        <div class="product-info-tabs">
		        <ul class="nav nav-tabs" id="myTab" role="tablist">
				  	<li class="nav-item">
				    	<a class="nav-link active" id="description-tab" data-toggle="tab" href="#description" role="tab" aria-controls="description" aria-selected="true">Descrição do livro</a>
				  	</li>
				  	<li class="nav-item">
				    	<a class="nav-link" id="review-tab" data-toggle="tab" href="#review" role="tab" aria-controls="review" aria-selected="false">Reviews ( {{ reviews.count }} )</a>
				  	</li>

				</ul>
				<div class="tab-content" id="myTabContent">
										
				  	<div class="tab-pane fade show active text-justify" id="description" role="tabpanel" aria-labelledby="description-tab">
				  		<div class="bottom-icone mb-5">

				  		<button id="play">
				  			<i class="far fa-play-circle" onclick="responsiveVoice.speak('{{ livro.Descricao  }}');" type="button" value="Play"></i>
				  		</button>	
						
						
						</div>
				  		{{ livro.descricao  | safe}}
				  	
				  	</div>
				  	<div class="tab-pane fade" id="review" role="tabpanel" aria-labelledby="review-tab">
				  		<div class="review-heading">REVIEWS</div>
				  		{% if reviews %}
				  		{% for review in reviews %}
				  		<div class="card">

				  		</div>
				  		{% endfor %}				  		
				  		{% else %}
				  		<p class="mb-20">Não há comentários ainda.</p>
				  		{% endif %}
				  		<form class="review-form">
		        			<div class="form-group">
			        			<label>Sua avaliação</label>
			        			<div class="reviews-counter">
									<form action="{% url 'livros:add_review' livro.id  %}" method="POST">
            						{% csrf_token %}	
									<div class="rating-pro">
										 <label>
										   <button type="submit" name="rate" value="10" id="rangeInput" title="10 stars"> 10</button>
										 </label>
										<label>
										  <button type="submit" name="rate" value="9" id="rangeInput" title="9 stars"> 9</button>
										</label>
										<label>
										  <button type="submit" name="rate" value="8" id="rangeInput" title="8 stars"> 8</button>
										</label>
										<label>
										  <button type="submit" name="rate" value="7" id="rangeInput" title="7 stars"> 7</button>
										</label>
										<label>
										 <button type="submit" name="rate" value="6" id="rangeInput" title="6 stars"> 6</button>
										</label>
										<label>
										 <button type="submit" name="rate" value="5" id="rangeInput" title="5 stars"> 5</button>
										</label>
										<label>
											<button type="radio" name="rate" value="4" id="rangeInput" title="4 stars"> 4</button>
										</label>
										<label>
											<button type="submit" name="rate" value="3" id="rangeInput" title="3 stars"> 3</button>
										</label>
										<label>
											<button type="submit" name="rate" value="2" id="rangeInput" title="2 stars"> 2</button>
										</label>
										<label>
											<button type="submit" name="rate" value="1" id="rangeInput" title="1 star"> 1</button>
										</label>
									</div>
								</form>
								</div>
							</div>
		        			<div class="form-group">
			        			<label>Sua mensagem</label>
			        			<textarea class="form-control" rows="10"></textarea>
			        		</div>
			        		<div class="row">
				        		<div class="col-md-6">
				        			<div class="form-group">
					        			<input type="text" name="" class="form-control" placeholder="Name*">
					        		</div>
					        	</div>
				        		<div class="col-md-6">
				        			<div class="form-group">
					        			<input type="text" name="" class="form-control" placeholder="Email Id*">
					        		</div>
					        	</div>
					        </div>
					        <button class="round-black-btn">Submit Review</button>
			        	</form>
				  	</div>
				</div>
			</div>			
		</div>
	</div>
	
	<script type="text/javascript">
		$(document).ready(function() {
		    var slider = $("#slider");
		    var thumb = $("#thumb");
		    var slidesPerPage = 4; //globaly define number of elements per page
		    var syncedSecondary = true;
		    slider.owlCarousel({
		        items: 1,
		        slideSpeed: 2000,
		        nav: false,
		        autoplay: false, 
		        dots: false,
		        loop: true,
		        responsiveRefreshRate: 200
		    }).on('changed.owl.carousel', syncPosition);
		    thumb
		        .on('initialized.owl.carousel', function() {
		            thumb.find(".owl-item").eq(0).addClass("current");
		        })
		        .owlCarousel({
		            items: slidesPerPage,
		            dots: false,
		            nav: true,
		            item: 4,
		            smartSpeed: 200,
		            slideSpeed: 500,
		            slideBy: slidesPerPage, 
		        	navText: ['<svg width="18px" height="18px" viewBox="0 0 11 20"><path style="fill:none;stroke-width: 1px;stroke: #000;" d="M9.554,1.001l-8.607,8.607l8.607,8.606"/></svg>', '<svg width="25px" height="25px" viewBox="0 0 11 20" version="1.1"><path style="fill:none;stroke-width: 1px;stroke: #000;" d="M1.054,18.214l8.606,-8.606l-8.606,-8.607"/></svg>'],
		            responsiveRefreshRate: 100
		        }).on('changed.owl.carousel', syncPosition2);
		    function syncPosition(el) {
		        var count = el.item.count - 1;
		        var current = Math.round(el.item.index - (el.item.count / 2) - .5);
		        if (current < 0) {
		            current = count;
		        }
		        if (current > count) {
		            current = 0;
		        }
		        thumb
		            .find(".owl-item")
		            .removeClass("current")
		            .eq(current)
		            .addClass("current");
		        var onscreen = thumb.find('.owl-item.active').length - 1;
		        var start = thumb.find('.owl-item.active').first().index();
		        var end = thumb.find('.owl-item.active').last().index();
		        if (current > end) {
		            thumb.data('owl.carousel').to(current, 100, true);
		        }
		        if (current < start) {
		            thumb.data('owl.carousel').to(current - onscreen, 100, true);
		        }
		    }
		    function syncPosition2(el) {
		        if (syncedSecondary) {
		            var number = el.item.index;
		            slider.data('owl.carousel').to(number, 100, true);
		        }
		    }
		    thumb.on("click", ".owl-item", function(e) {
		        e.preventDefault();
		        var number = $(this).index();
		        slider.data('owl.carousel').to(number, 300, true);
		    });


            $(".qtyminus").on("click",function(){
                var now = $(".qty").val();
                if ($.isNumeric(now)){
                    if (parseInt(now) -1> 0)
                    { now--;}
                    $(".qty").val(now);
                }
            })            
            $(".qtyplus").on("click",function(){
                var now = $(".qty").val();
                if ($.isNumeric(now)){
                    $(".qty").val(parseInt(now)+1);
                }
            });
		});
	</script>


	<script type="text/javascript">
		
		var = descricao = document.querySelector('#descricao')
		var = voiceList = document.querySelector('#voiceList')
		var = btnSpeak = document.querySelector('#play')
		var = synth = window.speechSynthesis;
		var = voices = []

		function NewVoices(){

			voices = synth.getVoices()
			var selectedIndex = voiceList.selectedIndex < 0 ? 0 : voiceList.selectedIndex
			voiceList.innerHTML= " "
			
		}
	</script>












<script type="text/javascript">
// Initialising the speech API
const synth = window.speechSynthesis;
   
// Element initialization section
const form = document.querySelector('form');
const textarea = document.getElementById('maintext');
const voice_select = document.getElementById('voice-select');
const rate = document.getElementById('rate');
const pitch = document.getElementById('pitch');
const rateval = document.getElementById('rate-value');
const pitchval = document.getElementById('pitch-value');
   
// Retrieving the different voices and putting them as 
// options in our speech selection section
let voices = [];
const getVoice = () => {
      
    // This method retrieves voices and is asynchronously loaded
    voices = synth.getVoices();
    var option_string = "";
    voices.forEach(value => {
        var option = value.name + ' (' + value.lang + ') ';
        var newOption = "<option data-name='" + value.name +
                "' data-lang='" + value.lang + "'>" + option
                + "</option>\n";
        option_string += newOption;
    });
      
    voice_select.innerHTML = option_string;
}
   
// Since synth.getVoices() is loaded asynchronously, this
// event gets fired when the return object of that 
// function has changed
synth.onvoiceschanged = function() {
    getVoice();
};
   
const speak = () => {
      
    // If the speech mode is on we dont want to load 
    // another speech
    if(synth.speaking) {
        alert('Already speaking....');
        return;
    }
       
    // If the text area is not empty that is if the input
    // is not empty
    if(textarea.value !== '') {
          
        // Creating an object of SpeechSynthesisUtterance with
        // the input value that represents a speech request
        const speakText = new SpeechSynthesisUtterance(textarea.value);
   
        // When the speaking is ended this method is fired
        speakText.onend = e => {
            console.log('Speaking is done!');
        };
          
        // When any error occurs this method is fired
        speakText.error = e=> {
            console.error('Error occured...');
        };
   
        // Selecting the voice for the speech from the selection DOM
        const id = voice_select.selectedIndex;
        const selectedVoice = 
            voice_select.selectedOptions[0].getAttribute('data-name');
    
        // Checking which voices has been chosen from the selection
        // and setting the voice to the chosen voice
        voices.forEach(voice => {
            if(voice.name === selectedVoice) {
                speakText.voice = voice;
            }
        });
   
        // Setting the rate and pitch of the voice
        speakText.rate = rate.value;
        speakText.pitch = pitch.value;
   
        // Finally calling the speech function that enables speech
        synth.speak(speakText);
    }
};
   
// This function updates the rate and pitch value to the
// value to display
rate.addEventListener('change', evt => rateval.innerHTML 
        = (Number.parseFloat(rate.value) * 10) + "");
  
pitch.addEventListener('change', evt => pitchval.innerHTML 
        = (Number.parseFloat(pitch.value) * 10) + "");
   
// This is the section when we assign the speak button, the
// speech function
form.addEventListener('submit', evt => {
    evt.preventDefault();
    speak();
    textarea.blur();
});

</script>
{% endblock %}















